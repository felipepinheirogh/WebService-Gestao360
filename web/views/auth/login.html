<!-- web/views/auth/login.html -->
<div class="container d-flex align-items-center justify-content-center min-vh-100">
  <div class="card shadow p-4" style="max-width: 350px; width: 100%;">
    <img src="/public/img/gestao360-logo.svg" class="mx-auto d-block mb-3" style="width:200px;" alt="Gestão 360°">
    <div class="alert alert-danger d-none" id="loginError">Usuário ou senha inválidos!</div>
    <form id="loginForm">
      <div class="input-group mb-3">
        <span class="input-group-text"><i class="bi bi-buildings"></i></span>
        <input type="text" class="form-control" id="empresa" placeholder="Empresa" required autocomplete="organization">
      </div>
      <div class="input-group mb-3">
        <span class="input-group-text"><i class="bi bi-person"></i></span>
        <input type="text" class="form-control" id="username" placeholder="Usuário" required autocomplete="username">
      </div>
      <div class="input-group mb-3">
        <span class="input-group-text"><i class="bi bi-key"></i></span>
        <input type="password" class="form-control" id="password" placeholder="Senha" required autocomplete="current-password">
      </div>
      <button type="submit" class="btn btn-dark w-100">Entrar</button>
    </form>
  </div>
</div>

<script>
  document.getElementById("loginForm").addEventListener("submit", async (e) => {
    e.preventDefault();
    const empresa = document.getElementById("empresa").value.trim();
    const username = document.getElementById("username").value.trim();
    const password = document.getElementById("password").value.trim();
    const errorDiv = document.getElementById("loginError");

    // Limpa mensagens anteriores
    errorDiv.classList.add("d-none");

    // Simulação de autenticação (substituir por API real depois)
    const users = [
      { empresa: "demo", username: "admin", password: "123", role: "admin" },
      { empresa: "demo", username: "user", password: "123", role: "user" }
    ];

    const user = users.find(u => u.empresa === empresa && u.username === username && u.password === password);

    if(user) {
      // Salva token e role
      localStorage.setItem("token", "fake-jwt-token");
      localStorage.setItem("role", user.role);

      // Recarrega página para SPA inicializar
      location.reload();
    } else {
      errorDiv.classList.remove("d-none");
    }
  });
</script>
